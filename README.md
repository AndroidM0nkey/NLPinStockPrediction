# NLPinStockPrediction

Данный проект будет посвящен созданию сервиса по предсказанию стоимости акций (Stock/Index) на основе ML/DL подхода.

By Степанов Семён

### (17.06.2024) Пример запроса к сервису

Существует 3 ручки:

- predict_dl (ml) -> возвращает ответ на одиночный запрос
- predict_dl_batch (ml) -> возвращает ответы на множество запросов
- dl_stats (ml) -> возвращает статистику по классам в текущей сессии

```
curl -X 'POST'   'http://51.250.19.65:5051/predict_batch_dl/'\ -H 'Content-Type: application/json'\ -d '{"texts": ["Stock market crashed", "With the new production plant theAccording to the company updated strategy f
or the years 2009-2012 , Basware targets a long-term net sales growth in the range of 20 % -40 % with an operating profit margin of 10 % -20 % of net sales"]}'
```

```
curl -X 'GET' 'http://51.250.19.65:5051/stats_dl/'
```

### Core задачи, которые хочется решить

- Уметь отвечать при помощи API на вопрос: вырастет/упадет/не изменится стоимости акции для приложенной новости

- Держать модель задеплоиной а рамках Yandex.Cloud с 24/7 возможностью для доступа к API

- Уметь дообучать модель на батчах размеченных данных {Новость + Как повлияла на стоимости акции}


### Базовые датасеты

Для первичного обучения и тестирования модели воспользуюсь рядом датасетов

- https://www.kaggle.com/datasets/aaron7sun/stocknews/
  Небольшой датасет за период с 2008 по 2016, включающий 3 таблицы: топ 25 новостей с Reddit WorldNews, данные по Dow Jones Index с Yahoo Finance и комбинированная таблица {Date, Marker(как изменился индекс, Новости)}.

  Данный датасет должен помочь в базовой задаче обучения и всилу небольшого размера может быть использован на ранних этапах экспериментов с моделью.

- https://www.kaggle.com/datasets/borismarjanovic/price-volume-data-for-all-us-stocks-etfs
  Большой датасет с подневными ценами на почти все акции Американских бирж. Сам датасет поделен на множество файлов - каждый для своей акции. Будет использован для создания комбинированного датасета акций + новостей, при помощи агрегации можно будет повторить ряд индексов (DJ, S&P500 ...)

- https://www.kaggle.com/datasets/borismarjanovic/price-volume-data-for-all-us-stocks-etfs
  Датасет с финансовыми новостями. Интересен своей разметкой - есть маппинг между новостью и упомянутыми в ней акциями/индексами. Будет использован в сочетании с датасетом подневной стоимости акций

- https://www.kaggle.com/datasets/rmisra/news-category-dataset
  Датасет включающий категорию, заголовок, дату и краткое описание новости. Такой датасет полезен, так как не только финансовые новости влияют на стоимости акций, а наличие суммаризованного описания должно упростить задачу. Будет использован в сочетании с датасетом подневной стоимости акций

Все датасеты сходятся по датам в промежутке 2008-2016

### План развития проекта

##### Разведочный анализ

Нужно создать комбинированный датасет, который маппит изменение стоимости акции к новости (или ряду новостей), учитывая форматы датасетов эта задача может быть автоматизирована, а логика, полученная на этом этапе будет использована при реализации Scraper. Так же стоит проанализировать признаки в датасетах, понять какие коррелируют/некорелируют c результатом

##### ML/DL

После анализа нужно заресерчить уже изученные методы, быстрым поиском находится много статей на google scholar, arxiv.org (тут воспользуемся обзорщиком чтобы отсеить множество китайских статей). Реализовать несколько наиболее интересных + забенчить их.

##### Сервис

Реализовать сервис. Предполагается использование mlflow для деплоя модели, docker для backend составляющей, раскатить все в рамках Yandex.Cloud

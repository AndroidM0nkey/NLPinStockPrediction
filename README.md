# NLPinStockPrediction

Данный проект будет посвящен созданию сервиса по предсказанию стоимости акций (Stock/Index) на основе ML/DL подхода.

By Степанов Семён

### (15.01.2024) Пример запроса к сервису

```
curl -X POST "http://158.160.28.16:8000/predict" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"title\":\"US government approves bitcoin etf\"}"
```

### Core задачи, которые хочется решить

- Уметь отвечать при помощи API на вопрос: вырастет/упадет/не изменится стоимости акции для приложенной новости

- Держать модель задеплоиной а рамках Yandex.Cloud с 24/7 возможностью для доступа к API

- Уметь дообучать модель на батчах размеченных данных {Новость + Как повлияла на стоимости акции}

- Реализовать сервис для дообучения. Некий realtime Scraper новостных сайтов + stock price для создания размеченных данных

Овервью архитектуры выглядит так

![alt text](https://github.com/AndroidM0nkey/NLPinStockPrediction/blob/main/architecture.png)

### Базовые датасеты

Для первичного обучения и тестирования модели воспользуюсь рядом датасетов

- https://www.kaggle.com/datasets/aaron7sun/stocknews/
  Небольшой датасет за период с 2008 по 2016, включающий 3 таблицы: топ 25 новостей с Reddit WorldNews, данные по Dow Jones Index с Yahoo Finance и комбинированная таблица {Date, Marker(как изменился индекс, Новости)}.

  Данный датасет должен помочь в базовой задаче обучения и всилу небольшого размера может быть использован на ранних этапах экспериментов с моделью.

- https://www.kaggle.com/datasets/borismarjanovic/price-volume-data-for-all-us-stocks-etfs
  Большой датасет с подневными ценами на почти все акции Американских бирж. Сам датасет поделен на множество файлов - каждый для своей акции. Будет использован для создания комбинированного датасета акций + новостей, при помощи агрегации можно будет повторить ряд индексов (DJ, S&P500 ...)

- https://www.kaggle.com/datasets/borismarjanovic/price-volume-data-for-all-us-stocks-etfs
  Датасет с финансовыми новостями. Интересен своей разметкой - есть маппинг между новостью и упомянутыми в ней акциями/индексами. Будет использован в сочетании с датасетом подневной стоимости акций

- https://www.kaggle.com/datasets/rmisra/news-category-dataset
  Датасет включающий категорию, заголовок, дату и краткое описание новости. Такой датасет полезен, так как не только финансовые новости влияют на стоимости акций, а наличие суммаризованного описания должно упростить задачу. Будет использован в сочетании с датасетом подневной стоимости акций

Все датасеты сходятся по датам в промежутке 2008-2016

### План развития проекта

##### Разведочный анализ

Нужно создать комбинированный датасет, который маппит изменение стоимости акции к новости (или ряду новостей), учитывая форматы датасетов эта задача может быть автоматизирована, а логика, полученная на этом этапе будет использована при реализации Scraper. Так же стоит проанализировать признаки в датасетах, понять какие коррелируют/некорелируют c результатом

##### ML/DL

После анализа нужно заресерчить уже изученные методы, быстрым поиском находится много статей на google scholar, arxiv.org (тут воспользуемся обзорщиком чтобы отсеить множество китайских статей). Реализовать несколько наиболее интересных + забенчить их.

##### Сервис

Реализовать сервис. Предполагается использование mlflow для деплоя модели, docker для backend составляющей, раскатить все в рамках Yandex.Cloud
